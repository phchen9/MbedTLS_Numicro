From 75a34adec1bead3ea9aef080f40b34ebeb96eff3 Mon Sep 17 00:00:00 2001
From: phchen9 <PHCHEN9@nuvoton.com>
Date: Thu, 31 Jul 2025 11:07:49 +0800
Subject: [PATCH] compatible with CryptoAccel

---
 include/mbedtls/platform_util.h | 3 +++
 library/ecdsa.c                 | 5 +++++
 2 files changed, 8 insertions(+)

diff --git a/include/mbedtls/platform_util.h b/include/mbedtls/platform_util.h
index adad6bc3f8..0407c7ed12 100644
--- a/include/mbedtls/platform_util.h
+++ b/include/mbedtls/platform_util.h
@@ -23,6 +23,9 @@
 extern "C" {
 #endif
 
+#define MBEDTLS_INTERNAL_VALIDATE_RET(cond, ret)  do { } while (0)
+#define MBEDTLS_INTERNAL_VALIDATE(cond)           do { } while (0)
+
 /* Internal helper macros for deprecating API constants. */
 #if !defined(MBEDTLS_DEPRECATED_REMOVED)
 #if defined(MBEDTLS_DEPRECATED_WARNING)
diff --git a/library/ecdsa.c b/library/ecdsa.c
index 2f7a996a7e..c8456b7fb5 100644
--- a/library/ecdsa.c
+++ b/library/ecdsa.c
@@ -222,6 +222,9 @@ cleanup:
 }
 #endif /* ECDSA_DETERMINISTIC || !ECDSA_SIGN_ALT || !ECDSA_VERIFY_ALT */
 
+#if !defined(MBEDTLS_ECDSA_SIGN_ALT)     || \
+    !defined(MBEDTLS_ECDSA_VERIFY_ALT)
+
 int mbedtls_ecdsa_can_do(mbedtls_ecp_group_id gid)
 {
     switch (gid) {
@@ -235,6 +238,8 @@ int mbedtls_ecdsa_can_do(mbedtls_ecp_group_id gid)
     }
 }
 
+#endif /* !ECDSA_SIGN_ALT || !ECDSA_VERIFY_ALT */
+
 #if !defined(MBEDTLS_ECDSA_SIGN_ALT)
 /*
  * Compute ECDSA signature of a hashed message (SEC1 4.1.3)
-- 
2.45.1.windows.1

